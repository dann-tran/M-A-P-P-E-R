<!-- 
    LAWS OF XXX
    First law: An XXX may not injure a human being or, through inaction, allow a human being come to harm.
    Second law: An XXX must obey orders given it by human beings except where such orders would conflict with the First Law.
    Third law: An XXX must protect its own existence as long as such protection does not conflict with the First or Second Law.
 -->

 <!-- 
     This being exists and does not exist at the same time. On one hand, 
  -->

<!DOCTYPE html>
<html>

<head>
	<title>Gaming life</title>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.1.9/lib/p5.js"></script>	
    <script src="https://picasdan9.github.io/gaming-life-assignment/EyeTemplate.js"></script>
</head>

<body style="background: black;">
    <div id="eyes"></div>
    <div id="epilepsy"></div>
    
    <script>

    let terrain = s => {
        const w = 1200, h = 900, scl = 20, cols = w / scl, rows = h / scl;
        const terrain = [];
        let flying = 0, speed = 0.1;
        let inconsolata;

        s.preload = () => {
            inconsolata = s.loadFont("https://picasdan9.github.io/gaming-life-assignment/Roboto-Regular.ttf");
            console.log(inconsolata);
        }

        s.setup = () => {
            s.createCanvas(600, 600, s.WEBGL);
            s.textFont(inconsolata);
            s.textSize(s.width / 3);
            s.textAlign(s.CENTER, s.CENTER);
        }

        s.draw = () => {
            if (s.keyIsDown(87)) flying -= speed;
            else if (s.keyIsDown(83)) flying += speed;
            let yoff = flying;

            for (let y = 0; y < rows; y++) {
                let xoff = 0;
                for (let x = 0; x < cols; x++) {
                    if (!terrain[x])
                        terrain[x] = []; 
                    terrain[x][y] = s.map(s.noise(xoff, yoff), 0, 1, -100, 100);
                    xoff += 0.2;
                }
                yoff += 0.2;
            }
            
            s.background(0);
            s.stroke(255);
            s.noFill();

            s.rotateX(s.PI/3);
            s.translate(-w/2, -h/2);

            for (let y = 0; y < rows - 1; y++) {
                s.beginShape(s.TRIANGLE_STRIP);
                for (let x = 0; x < cols; x++) {
                    s.vertex(x*scl, y*scl, terrain[x][y]);
                    s.vertex(x*scl, (y + 1)*scl, terrain[x][y + 1]);
                }
                s.endShape();
            }

            s.translate(w/2, h/2);

            s.fill(255);
            ["gaming", "life", "is", "meaningless"].forEach((t, idx) => {
                s.translate(0, -(10*idx + flying)*scl*10, 0);
                s.rotateX(-s.PI/2);
                s.text(t, 0, 0);
                s.rotateX(s.PI/2);
            })
        }
    }

    let epilepsy = s => {
        let RGB1, RGB2;
        const COL_WIDTH = 40;
        let COLS_NUM = 0;
        let isMadness = false;
        let eye;
        let madnessStart;
    
        s.setup = () => {
            s.createCanvas(s.windowWidth, s.windowHeight);
            COLS_NUM = s.width/(COL_WIDTH + 10);
            s.stroke(235);
            let Eye = EyeTemplate(s);
            eye = new Eye(Math.min(s.width, s.height)/2.6, 200, s.width/2, s.height/2, 250, false);
        }

        s.draw = () => {
            if (!isMadness) {
                s.background(0);
                isMadness = s.mouseY > s.height/2;
            }
            if (isMadness) {
                s.fill(0, 5);
                s.rect(0, 0, s.width, s.height);
                RGB1 = [s.random(s.mouseX), s.random(s.mouseY), s.random(s.mouseX)];
                RGB2 = [s.random(s.mouseY), s.random(s.mouseX), s.random(s.mouseY)];
                if (s.millis() - madnessStart > 5000)
                isMadnes = false;
            } 
        
            s.noStroke();
            s.fill(255);

            eye.display()
            s.fill(255, 255, 255);
            
            for (let i = 0; i < COLS_NUM; i++) {
                if (isMadness)
                    if (i % 2) s.fill(RGB1[0], RGB1[1], RGB1[2]);
                    else s.fill(RGB2[0], RGB2[1], RGB2[2]);
                s.rect(5*(2*i + 1) + i*COL_WIDTH, 0, 40, s.mouseY - 50, 0);
                s.rect(5*(2*i + 1) + i*COL_WIDTH, s.height, 40, -s.mouseY + 50, 0);
            }   
        }
    }

    let eyes = s => {
        const eyes = [];
        s.setup = () => {
            let Eye = EyeTemplate(s);
            s.createCanvas(s.windowWidth, 2040);
            s.background(0);
            for (let i = 0; i < s.width/150; i++)
                for (let j = 0; j < s.height/140; j++)
                    eyes.push(new Eye(s.random(50, 70), s.random(30, 50), 70 + i*150, 70 + j*140, 50));
        }
        s.draw = () => {
            s.background(0);
            for (let i = 0; i < eyes.length; i++)
                eyes[i].display();
        }
    }
    new p5(epilepsy, 'epilepsy');
    new p5(eyes, 'eyes');
    
    </script>
</body>
<style>
    * {
        margin: 0;
    }
</style>

</html>